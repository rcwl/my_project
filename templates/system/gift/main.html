<!DOCTYPE html>
<html>
<head>
    <title>兑换码管理</title>
    {% include 'system/common/header.html' %}
</head>
<body class="pear-container">

{# 查询表单 #}
<div class="layui-card">
    <div class="layui-card-body">
        <form class="layui-form" action="" lay-filter="query-form">
            <div class="layui-form-item" style="margin-bottom: unset;">
                <label class="layui-form-label">激活码</label>
                <div class="layui-input-inline">
                    <input type="text" name="key" placeholder="" class="layui-input">
                </div>
                <button class="layui-btn layui-btn-md" lay-submit lay-filter="gift-query">
                    <i class="layui-icon layui-icon-search"></i>
                    查询
                </button>
                <button type="reset" class="layui-btn layui-btn-primary layui-btn-md">
                    <i class="layui-icon layui-icon-refresh"></i>
                    重置
                </button>
            </div>
        </form>
    </div>
</div>

{# 用户表格 #}
<div>
    <div class="layui-card">
        <div class="layui-card-body">
            <table id="gift-table" lay-filter="gift-table"></table>
        </div>
    </div>
</div>
</body>

<!-- 这里写的都是表格一行元素组件 -->
{% raw %}
    <script type="text/html" id="enable-element">
        <input type="checkbox" name="enable" value="{{ d.id }}" lay-skin="switch" lay-text="启用|禁用"
               lay-filter="gift-enable"
               {{# if(d.enable==1){ }} checked {{# } }}/>
    </script>

    <script type="text/html" id="used-element">
        {{# if(d.used==1){ }}
        <span style="color: red">已用</span>
        {{# } else { }}
        <span style="color: green">未用</span>
        {{# } }}
    </script>

    <script type="text/html" id="createTime-element">
        {{layui.util.toDateString(d.create_at,  "yyyy-MM-dd HH:mm:ss")}}
    </script>
{% endraw %}


<script type="text/html" id="table-bar">
    {% if authorize("system:gift:edit") %}
        <button class="layui-btn layui-btn-xs" lay-event="edit"><i class="pear-icon pear-icon-edit"> 编辑</i>
        </button>
    {% endif %}
    {% if authorize("system:gift:remove") %}
        <button class="layui-btn layui-btn-danger layui-btn-xs" lay-event="remove"><i
                class="pear-icon pear-icon-ashbin"> 删除</i>
        </button>
    {% endif %}
</script>

<!-- 这里是表格的工具栏 -->
<script type="text/html" id="table-toolbar">
    {% if authorize("system:gift:add") %}
        <button class="layui-btn layui-btn-primary layui-btn-sm" lay-event="add">
            <i class="pear-icon pear-icon-add"></i>
            新增
        </button>
    {% endif %}
</script>


{% include 'system/common/footer.html' %}
<script>
    layui.use(['table'], function () {
        let table = layui.table;

        // 表格数据
        let cols = [
            [
                {title: '编号', field: 'id', align: 'center'},
                {title: '激活码', field: 'key', align: 'center'},
                {title: '内容', field: 'content', align: 'center'},
                {title: '启用', field: 'enable', align: 'center', templet: '#enable-element'},
                {title: '已用', field: 'used', align: 'center', templet: '#used-element'},
                {title: '创建时间', field: 'create_at', templet: '#createTime-element', align: 'center'},
                {title: '操作', toolbar: '#table-bar', align: 'center', width: 180}
            ]
        ]

        // 渲染表格数据
        table.render({
            elem: '#gift-table',
            url: '/system/gift/data',  // 请求链接
            page: true,
            cols: cols,
            skin: 'line',
            toolbar: '#table-toolbar',
            text: {none: '暂无激活码信息'},
            defaultToolbar: [{layEvent: 'refresh', icon: 'layui-icon-refresh'}, 'filter', 'print', 'exports']
        })

    })
</script>

</html>